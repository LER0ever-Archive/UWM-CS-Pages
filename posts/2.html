<!doctype html><head lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Page 2 - L.E.R Space</title><meta name=format-detection content="telephone=no"><script>if(self!=top){top.location=this.location.href;}</script><meta name=keywords content="LER0ever,L.E.R,Yi Rong,blog,L.E.R Space,Lumos"><meta name=description content="L.E.R Space, a magical personal website by Yi Rong"><link rel=icon href=/~rong/favicon.ico><link rel="shortcut icon" href=/~rong/favicon.ico><!--[if lt IE 9]>
    <script src="/js/html5.js" type="text/javascript"></script>
    <![endif]--><!--[if (gt IE 9)|!(IE)]>
    <script src="/js/jquery.mobile.customized.min.js" type="text/javascript"></script>
    <![endif]--><link rel=stylesheet id=font-style-css href=/~rong/css/fonts-google.css><link rel=stylesheet id=duena-bootstrap-css href=/~rong/bootstrap/css/bootstrap.css><link rel=stylesheet id=flexslider-css href=/~rong/css/magnific-popup.css><link rel=stylesheet id=magnific-css href=/~rong/css/flexslider.css><link rel=stylesheet id=font-awesome-css href=/~rong/css/font-awesome.css><link rel=stylesheet id=duena-style-css href=/~rong/css/style.css><link rel=stylesheet href=/~rong/css/hljs/monokai-sublime.css><style id=duena-style-inline-css>a,.searchform .screen-reader-text,.post_meta i,.author_bio_sidebar .social_box a,.post-title a:hover,.post-footer i,.page_nav_wrap .post_nav ul li .current,.page_nav_wrap .post_nav ul li a:hover{color:#ff5b5b}.post_type_label,.flex-direction-nav a,#content .featured_badge,.author_bio_sidebar .social_box,.flex-control-paging li a.flex-active,.flex-control-paging li a:hover,#toTop,.post-footer a,.navbar_inner>div>ul ul,.navbar_inner>ul ul,.btn.btn-primary,input[type=submit],input[type=reset]{background-color:#ff5b5b}.site-info,.widget,#slider-wrapper .flexslider,.navbar_inner>div>ul>li>a,.navbar_inner>div>ul>li>a:hover,.navbar_inner>div>ul>li.sfHover>a,.navbar_inner>div>ul>li.current-menu-item>a,.navbar_inner>div>ul>li.current_page_item>a,.navbar_inner>ul>li>a,.navbar_inner>ul>li>a:hover,.navbar_inner>ul>li.sfHover>a,.navbar_inner>ul>li.current-menu-item>a,.navbar_inner>ul>li.current_page_item>a,.breadcrumb,#comments,.post-footer a,.author-info{border-color:#ff5b5b}a:hover,a:focus{color:#71a08b}.btn.btn-primary:hover,input[type=submit]:hover,input[type=reset]:hover,.slider-caption .btn.btn-primary:hover{background-color:#71a08b}textarea:focus,input[type=text]:focus,input[type=password]:focus,input[type=datetime]:focus,input[type=datetime-local]:focus,input[type=date]:focus,input[type=month]:focus,input[type=time]:focus,input[type=week]:focus,input[type=number]:focus,input[type=email]:focus,input[type=url]:focus,input[type=search]:focus,input[type=tel]:focus,input[type=color]:focus,.uneditable-input:focus{border-color:#ff5b5b;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 2px #ff5b5b}</style><script src=/~rong/js/jquery-2.1.4.min.js></script><body class=post-list data-perma=post-page-2><div class=page-wrapper><header id=header role=banner><div class="container clearfix"><div class=logo><h1 class=text-logo><a href=https://pages.cs.wisc.edu/~rong title="L.E.R Space" rel=home>L.E.R Space</a></h1><p class=site-description>@UW-Madison 沉着、淡定、超脱</div><div id=top-search><input name=s class=input-search placeholder="Click here or double-tap Alt to Search" id=searchbox><input type=submit id=submit></div><div class=clear></div><nav id=site-navigation class=main-nav role=navigation><div class=navbar_inner><ul id=topnav class=sf-menu><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href=/~rong>Home</a><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href=/~rong/links>Links</a><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href=/~rong/sn>Contact Me</a><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href=/~rong/academic>Academics</a><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href=/~rong/veta>My Magic</a><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href=/~rong/archive>Archive</a><li class="menu-item menu-item-type-post_type menu-item-object-page"><a href=http://rongyi.ml target=_blank>中文网站</a></ul></div></nav></div></header><div id=main class=site-main><div class=container><ul class="breadcrumb breadcrumb__t"><li><a href=https://pages.cs.wisc.edu/~rong>Home</a><li class=divider>/</ul><div class=row><div id=primary class="col-md-8 right"><div id=content class=site-content role=main><header class=page-header></header><article id=post-1 class="post__holder post type-post status-publish format-standard hentry"><header class=post-header><h3 class=post-title><a href=/~rong/2016/3/10/alphago-intro-mcts.html title="Permalink to: AlphaGo Tech 1 - MCTS">AlphaGo Tech 1 - MCTS</a></h3></header><div class=post_content><div class=excerpt><h5 id=sorry-this-post-is-still-under-translation-to-english>Sorry, this post is still under translation to English</h5><p>首先， AlphaGo和李世石之间的对决是不公平的，AlphaGo的逻辑模块只能用于下围棋，相当于李世石用他的人类大脑挑战一个专门训练成只能用于下围棋的大脑。去年10月在英国挑战樊麾的时候AlphaGo的核心数是1200个CPU和170个GPU，而挑战李世石的时候AlphaGo用了1920个CPU。围棋界有个Elo的参数用来评价围棋手，李世石Elo为3532，去年10月的AlphaGo的Elo值为3168，值得注意的是中国棋手柯洁的Elo为3634。<p>AlphaGo总体来讲用了Google DeepMind的Policy Network 和 Value Network指引Monte Carlo算法，相当于用深度学习的技术来引导一个高明的搜索。(其实还有一个Fast Rollout用来快速走子，感谢@dlfall的提醒，总体来说是四个部分:决策网络、价值网络、快速走子和蒙特卡洛树搜索)</div><a href=/~rong/2016/3/10/alphago-intro-mcts.html class=more_link>Read More</a></div><div class="post_meta default"><i class="fa fa-tags"></i>Tags: <a href=/tags/AlphaGo.html rel=tag>AlphaGo</a></div><span class=post_type_label></span><span class=post_date><time>March 10, 2016</time></span><div class="post_meta default"><span class=post_category><a href=/category/Algorithms.html rel="category tag">Algorithms</a></span>
<span class=post_comment><i class="fa fa-comments"></i><a href=https://etasry.ml/ler/1120#respond class=comments-link>No comments</a></span>
<span class=post_author><i class="fa fa-user"></i><a href=https://etasry.ml/author/l-e-r title="Posts by L.E.R" rel=author>L.E.R</a></span><div class=clear></div></div></article><article id=post-1 class="post__holder post type-post status-publish format-standard hentry"><header class=post-header><h3 class=post-title><a href=/~rong/2015/1/22/simple-cnn.html title="Permalink to: Simple CNNs">Simple CNNs</a></h3></header><div class=post_content><div class=excerpt><h5 id=a-simple-implementation-of-convolutional-neural-networks>A simple implementation of Convolutional Neural Networks</h5><pre><code class=language-cpp>namespace CNN{
    vector split(string&amp; str,const char* c)
    {
        char *cstr, *p;
        vector res;
        cstr = new char[str.size()+1];
        strcpy(cstr,str.c_str());
        p = strtok(cstr,c);
        while(p!=NULL)
        {
            res.push_back((double)atof(p) );
            p = strtok(NULL,c);
        }

        return res;
    }

    double sigmoid(double z){
        return 1.0/(1.0 + pow(e,-z));
    }

}

vector* pool(vector&lt;vector&lt;vector &gt; &gt; *originOutput,const int sampleRateX,const int sampleRateY){
    vector *pooledData = new vector(originOutput-&gt;size());
    for (int i = 0; i &lt; originOutput-&gt;size(); i++) {
        Patch *layerOutput = new Patch();
        for (int j = 0; j &lt; (*originOutput)[i].size();j += sampleRateX ) {
            vector *oneRow = new vector();
            for (int k = 0; k &lt; (*originOutput)[i][j].size(); k += sampleRateY ) {
                double max = 0.0;
                for (int m = 0; m &lt; sampleRateX; m++) {
                    for (int n = 0; n &lt; sampleRateY; n++) {

                        if (max &lt; (*originOutput)[i][j + m][k + n]) {
                            max = (*originOutput)[i][j + m][k + n];
                        }
                    }
                }
                oneRow-&gt;push_back(max);
            }
            layerOutput-&gt;push_back((*oneRow));
        }
        (*pooledData)[i] = (*layerOutput);
    }
    originOutput-&gt;clear();
    originOutput = new vector(*pooledData);
    return originOutput;
}

void getParas(string filepPath){
    ifstream ifs;

    try {
        ifs.open((filepPath).c_str());

        string str;
        while (!ifs.eof()) {
            //get w1
            for (int i = 0; i &lt; conv_hiddenNodes; i++ ) {
                getline(ifs, str);
                w1-&gt;push_back(CNN::split(str,&quot;,&quot;));
            }
            cout&lt;size()&lt;&lt;endl;
            //get b1
            getline(ifs, str);
            *b1 = CNN::split(str,&quot;,&quot;);
            cout&lt;size()&lt;&lt;endl;
            //get means
            getline(ifs, str);
            *means = CNN::split(str,&quot;,&quot;);
            cout&lt;size()&lt;&lt;endl;

            //get stds
            getline(ifs, str);
            *stds = CNN::split(str, &quot;,&quot;);
            cout&lt;size()&lt;&lt;endl;
            break;
        }


        ifs.close();
    } catch (ifstream::failure e) {
        cout&lt;&lt;&quot;Exception opening/reading/closing filen&quot;;
    }


}

vector* vetorized(Patch *patch){
    vector *res = new vector();
    for (int i = 0; i &lt; patch-&gt;size(); i++) {
        for (int j = 0; j &lt; (*patch)[i].size(); j++) {
            res-&gt;push_back((*patch)[i][j]);
        }
    }
    return res;
}



void preprocess(vector *vec_pat){
    for (int i = 0; i &lt; vec_pat-&gt;size() ; i++) {
        (*vec_pat)[i] -= (*means)[i];
        (*vec_pat)[i] /= (*stds)[i];

    }
}

vector *forward2Middle(Patch *patch){
    vector *res = new vector();
    vector *patch_vec = vetorized(patch);
    preprocess(patch_vec);

    for (int i = 0; i &lt; conv_hiddenNodes ; i ++) {
        double h = 0.0;
        for (int j = 0; j &lt; inputNodes; j++) {
            h += (*patch_vec)[j] * (*w1)[i][j];
        }
        h += (*b1)[i];
        h = CNN::sigmoid(h);

        res-&gt;push_back(h);
    }

    return res;
}


vector* forward(vector&lt;vector &gt; *patches){
    int patchesSizeX = (int)patches-&gt;size();
    int patchesSizeY = (int)(*patches)[0].size();
    vector *middleLayerOutput  = new vector(conv_hiddenNodes,vector&lt;vector &gt;(patchesSizeX,vector(patchesSizeY)));
    for (int i = 0; i &lt; patchesSizeX; i++) {
        for (int j = 0; j &lt; patchesSizeY; j++) {
            vector *res =  forward2Middle(&amp;(*patches)[i][j]);
            for (int k = 0; k &lt; res-&gt;size(); k++) {
                (*middleLayerOutput)[k][i][j] = (*res)[k];
            }
        }
    }
    return middleLayerOutput;
}

string stringlized(const vector&lt;vector&lt;vector &gt; &gt; *pooledOutput){
    stringstream ss;

    for (int i = 0; i &lt; pooledOutput-&gt;size(); i++) {
        for (int j = 0; j &lt; (*pooledOutput)[i].size(); j++) {
            for (int k = 0; k &lt; (*pooledOutput)[i][j].size(); k++) {
                ss&lt;&lt;&quot;,&quot;&lt;&lt; (*pooledOutput)[i][j][k];
            }
        }
    }
    return ss.str();
}
string int2str(const int value){
    string str;

    return str;

void savetoDisk(const vector&lt;vector&lt;vector &gt; &gt; *pooledOutput,string filePath,bool isTrain,int sampleId = 0,int ylabel = -1){
    ofstream fs;
    try {

        if (isTrain) {
            if (!trainFirstFlag) {
                fs.open(filePath.c_str(),ios::app|ios::out);
            }else{
                fs.open(filePath.c_str(),ios::ate|ios::out);
                trainFirstFlag = false;
                fs&lt;&lt;&quot;Id,label,value&quot;&lt;&lt;endl;

            }
            stringstream ss;

            ss &lt;&lt; sampleId&lt;&lt;&quot;,&quot;&lt;&lt;ylabel;
            string str = ss.str();

            str += stringlized(pooledOutput);
            fs&lt;&lt;str&lt;&lt;endl;

        }else{
            if (!testFirstFlag) {
                fs.open(filePath.c_str(),ios::app|ios::out);
            }else{
                fs.open(filePath.c_str(),ios::ate|ios::out);
                fs&lt;&lt;&quot;Id,value&quot;&lt;&lt;endl;
                testFirstFlag = false;
            }
            stringstream ss;
            ss &lt;&lt; sampleId;
            string str = ss.str();
            str += stringlized(pooledOutput);
            fs&lt;&lt;str&lt;&lt;endl;

        }
        fs.close();

    } catch (fstream::failure err) {
        cout&lt;&lt;&quot;Cannot open output file!&quot;&lt;&lt;endl;
    }
}




vector&lt;vector &gt;* transfer2Twodimention(const vector *rowVec ,const int first_dimension){
    vector&lt;vector &gt; *res = new vector&lt;vector &gt;(first_dimension);
    int cols = (int)rowVec-&gt;size() / first_dimension;

    for (int i = 0 ; i &lt; first_dimension; i++) {
        for (int j = 0; j &lt; cols; j++) {
            (*res)[i].push_back( (*rowVec)[i * cols + j]);
        }
    }

    return res;

}


vector&lt;vector &gt;* getPatches(Image *image,int patchX,int patchY){
    int patchesX = ((int)image-&gt;size() - patchX +1)  ;
    int patchesY = ((int)(*image)[0].size() - patchY  + 1);

    vector&lt; vector &gt; *patches = new vector&lt;vector &gt;(patchesX,vector(patchesY));

    for (int i = 0; i&lt; patchesX; i++) {
        Patch apatch = Patch(patchX);
        for (int j = 0; j &lt; patchesY; j++) {
            for (int k = 0; k &lt; patchX; k++) {
                for (int m = 0; m &lt; patchY; m++) {
                    apatch[k].push_back( (*image)[i + k][ j + m]);
                }
            }
            (*patches)[i][j] = apatch;
        }
    }
    return patches;

}


void convol( FileReader* fileReader,const int patchSizeX,const int patchSizeY,const int middleNodes){
    conv_hiddenNodes = middleNodes;
    inputNodes = patchSizeX * patchSizeY;
    string filePath = &quot;sparsePara.csv&quot;;
    string trainPath = &quot;train.csv&quot;;
    string testPath = &quot;test.csv&quot;;

    getParas(filePath);

    const vector&lt;vector &gt; *trainX = (fileReader-&gt;getTrainX());
    const vector&lt;vector &gt; *trainY = fileReader -&gt; getTrainY();
    const vector&lt;vector &gt; *testID = fileReader-&gt;getTestID();

    for (int i = 0; i &lt; trainX-&gt;size(); i++) {
        Image *image = transfer2Twodimention(&amp;(*trainX)[i], sizeX);

        vector&lt;vector &gt; *patches;
        patches = getPatches(image, patchSizeX, patchSizeY);

        vector *middleOutput = forward(patches);

        middleOutput = pool(middleOutput, samRateX, samRateY);     // now middleOutput saves the pooled output
        int y = int((*trainY)[i][0]);
        savetoDisk(middleOutput, trainPath, true,0,y);
        delete patches;
        delete middleOutput;
        cout&lt;&lt;i&lt;&lt;endl;
     }
}
</code></pre></div><a href=/~rong/2015/1/22/simple-cnn.html class=more_link>Read More</a></div><div class="post_meta default"><i class="fa fa-tags"></i>Tags: <a href=/tags/CNNs.html rel=tag>CNNs</a></div><span class=post_type_label></span><span class=post_date><time>January 22, 2015</time></span><div class="post_meta default"><span class=post_category><a href=/category/Artificial%20Intelligence.html rel="category tag">Artificial Intelligence</a><a href=/category/Deep%20Learning.html rel="category tag">Deep Learning</a></span>
<span class=post_comment><i class="fa fa-comments"></i><a href=https://etasry.ml/ler/1120#respond class=comments-link>No comments</a></span>
<span class=post_author><i class="fa fa-user"></i><a href=https://etasry.ml/author/l-e-r title="Posts by L.E.R" rel=author>L.E.R</a></span><div class=clear></div></div></article><div class=page_nav_wrap><div class=post_nav><ul class=page-numbers><li><a class="prev page-numbers" href=/~rong/posts/1.html>← Prev</a></ul></div></div></div></div><div id=secondary class="widget-area col-md-4" role=complementary><div class=author_bio_sidebar><div class=social_box><a href=https://twitter.com/etasry><i class="fa fa-twitter"></i></a><a href=https://www.facebook.com/LER0ever><i class="fa fa-facebook"></i></a><a href=https://plus.google.com/110550757230711569932><i class="fa fa-google-plus"></i></a><a href><i class="fa fa-linkedin"></i></a><a href=/feed.xml><i class="fa fa-rss"></i></a></div><div class=content_box><h2>Welcome to my site</h2><div class=author_bio_message>Hello, and welcome to my site! I hope you like the place and decide to stay.</div><h6>This is the <a href=http://yirong.ml target=_blank>Global English Site</a><br>点击前往 <a href=http://rongyi.ml target=_blank>中文网站</a></h6></div></div><aside id=recent-posts-2 class="widget widget_recent_entries"><h3 class=widget-title>Recent</h3><ul><li><a href=/~rong/2016/9/3/lumos.html>HydroDev, Powerful DevPack</a><li><a href=/~rong/2016/8/5/welcome.html>About this New Site</a><li><a href=/~rong/2016/8/5/lumos.html>Lumos Static Site Generator</a><li><a href=/~rong/2016/3/11/alphago-intro-dl.html>AlphaGo Tech 2 - Deep Learning</a><li><a href=/~rong/2016/3/11/hhcm-mariadb-acc-php.html>HHVM&#43;MariaDB make PHP faster</a><li><a href=/~rong/2016/3/10/alphago-intro-mcts.html>AlphaGo Tech 1 - MCTS</a><li><a href=/~rong/2015/1/22/simple-cnn.html>Simple CNNs</a></ul></aside><aside id=categories-2 class="widget widget_categories"><h3 class=widget-title>Categories</h3><ul><li class=cat-item><a href=/category/Algorithms.html>Algorithms</a>(2)<li class=cat-item><a href=/category/Artificial%20Intelligence.html>Artificial Intelligence</a>(1)<li class=cat-item><a href=/category/Build%20System.html>Build System</a>(1)<li class=cat-item><a href=/category/Deep%20Learning.html>Deep Learning</a>(2)<li class=cat-item><a href=/category/Go.html>Go</a>(2)<li class=cat-item><a href=/category/Website.html>Website</a>(3)</ul></aside><aside id=tag_cloud-3 class="widget widget_tag_cloud"><h3 class=widget-title>Tags</h3><div class=tagcloud><a href=/tags/AlphaGo.html class="tag-link tag-link-position" style=font-size:8pt>AlphaGo</a>
<a href=/tags/CNNs.html class="tag-link tag-link-position" style=font-size:8pt>CNNs</a>
<a href=/tags/HydroDev.html class="tag-link tag-link-position" style=font-size:8pt>HydroDev</a>
<a href=/tags/Lumos.html class="tag-link tag-link-position" style=font-size:8pt>Lumos</a></div></aside></div></div></div></div></div><footer id=footer><div class="container text-center"><p><a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>CC BY-NC-ND 4.0</a> |
<a href=/~rong/feed.xml>Feed</a> |
<a href=/~rong/sitemap.xml>Sitemap</a><p>Powered by <a href=http://github.com/LER0ever/Lumos>Lumos Engine 0.0.2 (alpha)</a></p><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-81922310-1','auto');ga('send','pageview');</script><script async src=//www.google-analytics.com/analytics.js></script></div></footer><div class=search-tool style=position:fixed;top:0;bottom:0;left:0;right:0;opacity:.95;background-color:#111;z-index:9999;display:none><input class="form-control search-content" id=search-content style=position:fixed;top:60px placeholder="文章标题 分类 标签 (L.E.R Space 站内搜索)"><div style=position:fixed;top:16px;right:16px><img src=/~rong/search/img/close.png id=close-btn></div></div><link rel=stylesheet href=/~rong/search/css/search.css><script src=/~rong/search/js/bootstrap3-typeahead.min.js></script><script src=/~rong/search/js/search.js></script><footer id=colophon class=site-footer role=contentinfo><div class=container><div class="site-info col-md-12"><div class=footer-text><b>Copyright © 2014-2016 L.E.R Space</b></div><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-81922310-1','auto');ga('send','pageview');</script><script async src=//www.google-analytics.com/analytics.js></script><div class=clear></div><div id=toTop><i class="fa fa-chevron-up"></i></div></div></div></footer><script src=/~rong/js/navigation.js></script><script src=/~rong/js/skip-link-focus-fix.js></script><script src=/~rong/js/superfish.js></script><script src=/~rong/js/jquery.mobilemenu.js></script><script src=/~rong/js/sfmenu-touch.js></script><script src=/~rong/js/jquery.flexslider.js></script><script src=/~rong/js/jquery.magnific-popup.js></script><script src=/~rong/js/bootstrap.js></script><script src=/~rong/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script src=/~rong/js/custom.js></script><script>jQuery(function(){jQuery('.navbar_inner > ul').superfish({delay:1000,animation:{opacity:"show",height:"show"},speed:'normal',autoArrows:false,dropShadows:false});jQuery('.navbar_inner > div > ul').superfish({delay:1000,animation:{opacity:"show",height:"show"},speed:'normal',autoArrows:false,dropShadows:false});});jQuery(function(){var ismobile=navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(android)|(webOS)/i)
if(ismobile){jQuery('.navbar_inner > ul').sftouchscreen();jQuery('.navbar_inner > div > ul').sftouchscreen();}});</script><script>jQuery(function(){jQuery('.navbar_inner > ul').mobileMenu();jQuery('.navbar_inner > div > ul').mobileMenu();})</script><script>(function(){var request,b=document.body,c='className',cs='customize-support',rcs=new RegExp('(^|\\s+)(no-)?'+cs+'(\\s+|$)');request=true;b[c]=b[c].replace(rcs,' ');b[c]+=(window.postMessage&&request?' ':' no-')+cs;}());</script>